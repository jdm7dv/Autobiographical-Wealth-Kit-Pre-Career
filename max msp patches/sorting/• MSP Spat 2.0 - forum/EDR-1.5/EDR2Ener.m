function [FOD, OD, R1, R2, R3] = EDR2Ener2(EDR, SFCTtime, SFCTFreq, Tbegin, Tlimits)% EDR2Ener (EDR-1.5)%% [FOD, OD, R1, R2, R3] = EDR2Ener(EDR,STFTtime, STFTfreq, Tbegin, Tlimits)%% This function computes the energy (versus frequency) of the differents parts % of a room impulse response (FOD, OD, R1, R2, R3) %% EDR      : Energy decay relief of the room impulse response% STFTtime : time scale associated with the EDR% STFTfreq : frequency scale associated with the EDR% Tbegin   : arrival time of the direct sound% Tlimits  : begin times of the different sections of the impulse%            room response : [t1 t2 t3] corresponding to the beginnings%            of section R1, R2 , R3. Defaults is [20 40 100]% % See also : EDRanalysis, RI2Spat, Ener2MatSpat, MatSpat2criterror(nargchk(4, 5,nargin));fprintf('Computation of the energy\n')if ~exist('Tlimits')     fprintf('Using default values for limit times : 20 40 100\n');     Tlimits = [20 40 100]; endTlimits = 0.001 * Tlimits;		% convertit en secondessiz = size(EDR);if(siz(1) ~= length(SFCTFreq)) EDR = EDR';				% spectres en colonnesendX = SFCTtime;Y = EDR';XI = [ Tbegin Tbegin+0.005 Tbegin+Tlimits(1) Tbegin+Tlimits(2) Tbegin+Tlimits(3) ];YI = interp1(X,Y,XI);%fprintf('for %g, %g, %g, %g, %g seconds\n', XI(1), XI(2), XI(3), XI(4), XI(5))FOD = YI(1,:) - YI(2,:);OD  = YI(1,:) - YI(3,:);R1  = YI(3,:) - YI(4,:);R2  = YI(4,:) - YI(5,:);R3  = YI(5,:);
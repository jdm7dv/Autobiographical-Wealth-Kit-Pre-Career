function [ODtime, ODTimeSample] = TimeOD(RI,fe)% TimeOD%   %      ODtime, ODTimeSample] = TimeOD(RI,sr)% % Detect the arrival time of the direct signal in a room % impulse response % % RI     : Room Impulse response signal% sr     : sampling rate of the Impulse response%% ODtime : arrival time in seconds of the direct signal% ODTimeSample : arrival time in samples of the direct signalRI = RI(:);if (nargin == 2)  %methode basee sur la presence du premier pic  m = max(abs(RI));  dsat=1;  while (abs(RI(dsat))<=m/10)    dsat=dsat+1;  end  ODTimeSample=dsat-1;  ODtime = ODTimeSample/fe;elseif (nargin==4)   %detection de rupture de modele probabiliste      if (size(sig,1) == 1)      long = size(sig,2);     eps*ones(taillef,1);     Thesig = [eps*ones(1,taillef); sig; eps*ones(1,taillef+1)];     size(Thesig)   else     long = size(sig,1);     Thesig = [eps*ones(taillef,1); sig; eps*ones(taillef+1,1)];   end   m1 = zeros(1,long);   m2 = zeros(1,long);   var1 = zeros(1:long);   var2 = zeros(1:long);  for i=(taillef+1):long      fen1(1:taillef)=Thesig(i-taillef:i-1);      fen2(1:taillef)=Thesig(i:i+taillef-1);        m1(i) = sum(fen1)/taillef;      m2(i) = sum(fen2)/taillef;        fen1C = fen1 - m1(i)*ones(size(fen1));      var1(i) = sum(fen1C.*fen1C)/taillef;      fen2C = fen2 - m2(i)*ones(size(fen2));      var2(i) = sum(fen2C.*fen2C)/taillef;  endelse    fprintf('Nombre d''arguments incorrect\n');end
function [VecOut] = Smooth8va(VecIn, Freq)% [VecOut] = Smooth8va(VecIn, Freq)%% Effectue une reduction en 7 bandes d'octaves du vecteur InVec% Les bandes d'octaves sont centrees sur 125, 250, 500, 1000, 2000% 4000, 8000% Le lissage est pondere par une fenetre. Soit Fi la frequence centrale% de la band i : La fenetre est 0.5*(1+cos(2*pi*log2(F/Fi))) sur [Fi/sqrt(2); Fi*sqrt(2)]Bandes = [[125/sqrt(2) 125 125*sqrt(2)]',[250/sqrt(2) 250 250*sqrt(2)]',[500/sqrt(2) 500 500*sqrt(2)]',[1000/sqrt(2) 1000 1000*sqrt(2)]',[2000/sqrt(2) 2000 2000*sqrt(2)]',[4000/sqrt(2) 4000 4000*sqrt(2)]',[8000/sqrt(2) 8000 8000*sqrt(2)]']'; for i= 1:7 ligne = Bandes(i, :); wfin = zeros(size(Freq));  w(2:length(Freq)) = 0.5*(1+cos(2*pi*log(Freq(2:length(Freq))/ligne(2))/log(2))); w(1) = 0;   bInf = find(Freq < ligne(1)); bInf = bInf(length(bInf));  if(w(bInf)> w(bInf+1)) 	bInf = bInf+1; end if(w(bInf) > w(bInf-1)) 	bInf = bInf-1; end bSup = find(Freq>ligne(3));  if(isempty(bSup))    bSup = length(Freq)-1; else    bSup = bSup(1);  end  if(w(bSup)> w(bSup+1)) 	bSup = bSup+1; end  if(w(bSup) > w(bSup-1)) 	bSup = bSup-1; end  wfin(bInf:bSup) = w(bInf:bSup); VecOut(i) =sum(VecIn.*wfin)/sum(wfin);end 
function [] = bafplanpist(fe,Nfft,res,range);% function [] =  bafplanpist(fe,Nfft,res,range);%% fe : frequence d'echantillonnage% Nfft : nombre de points de la FFT% res : resolution angulaire du calcul% range : plage de frequences du calcul : [0 , range]c = 340; rho = 1.2;res_freq = fe/Nfft;freq = 0:res_freq:range; om = 2*pi*freq; k = om/c;res_ang = 5;theta = -90:res_ang:90; theta = theta'*pi/180;a = 5e-2       % a : rayon du Hpr = 1          % d : distance Hp-microdisp(' '); disp('Calcul en cours ...'); disp(' ');j = sqrt(-1);for n = 1:length(om)  p0 = j*2*pi*a^2*k(n)*rho*c/(4*pi);  for t = 1:length(theta)    z = k(n)*a*sin(theta(t));    if z == 0      D(t,n) = 1;    else      D(t,n) = 2*besselj(1,z)/z;    end    P(t,n) = p0*(exp(-j*k(n)*r)/r)*D(t,n);  endendsize(D)plotfreq = 0;while ~isempty(plotfreq)  plotfreq = input('frequence pour affichage ? ');  if  ~isempty(plotfreq)    curs = find(freq<plotfreq);    clf; polar(theta,abs(P(:,curs(length(curs)))),'r')    disp(['frequence reelle : ' num2str(freq(curs(length(curs))))]); disp(' ');  endend